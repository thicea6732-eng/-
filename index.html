<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tokyo & Seoul Vibe Planner</title>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet" />

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            // æ–°çš„æ·¡é›…é…è‰²
            'vibe-bg': '#fcfaf8', // å¥¶ç™½è‰²/æ·¡é»ƒè‰² (ä¸»åº•è‰²)
            'vibe-card': '#ffffff', // å¡ç‰‡ç´”ç™½
            'vibe-primary': '#003366', // æ·±è—è‰² (æ–‡å­—/å¼·èª¿è‰²ï¼Œæœ‰è³ªæ„Ÿ)
            'vibe-accent': '#fa709a', // å¯æ„›ç²‰è‰² (é»ç¶´è‰²/Icon)
            'vibe-shadow': '#e0e0e0', // é™°å½±
            'vibe-rose': { 100: '#ffe4e6', 500: '#fda4af', 700: '#be123c' },
            'vibe-blue': { 100: '#e0f2fe', 500: '#7dd3fc', 700: '#0369a1' }
          },
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
        }
      }
    }
  </script>
  <style>
    body { -webkit-font-smoothing: antialiased; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="bg-vibe-bg text-vibe-primary h-screen overflow-hidden">
  
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // --- å¯æ„› Icon çµ„ä»¶ (ä½¿ç”¨ Remix Icon) ---
    const RiIcon = ({ name, size = 20, className = "" }) => (
      <i className={`ri-${name} ri-${size}px ${className}`}></i>
    );

    // --- è³‡æ–™å±¤ (å¯éš¨æ™‚ä¿®æ”¹æ–°å¢) ---
    const flightsData = [
      { id: 1, date: '12/20 (å…­)', type: 'å»ç¨‹', airline: 'è™èˆª IT200', dep: 'æ¡ƒåœ’ T1 06:10', arr: 'æˆç”° T2 10:35', duration: '3h 25m', color: 'rose' },
      { id: 2, date: '12/24 (ä¸‰)', type: 'ä¸­ç¨‹', airline: 'å¾·å¨ TW244', dep: 'æˆç”° T2 14:35', arr: 'ä»å· T1 17:45', duration: '3h 10m', color: 'blue' },
      { id: 3, date: '12/27 (å…­)', type: 'å›ç¨‹', airline: 'è¯èˆª CI163', dep: 'ä»å· T2 20:15', arr: 'æ¡ƒåœ’ T1 22:10', duration: '2h 55m', color: 'rose' },
    ];
    
    const accommodationData = [
      { location: 'æ—¥æœ¬æ±äº¬ (4æ™š)', hotel: 'Keisei Richmond Hotel', dates: '12/20 - 12/24', note: 'éŒ¦ç³¸ç”º' },
      { location: 'éŸ“åœ‹é¦–çˆ¾ (3æ™š)', hotel: 'å¼˜å¤§ä½å®¿', dates: '12/24 - 12/27', note: 'å¼˜å¤§7è™Ÿå‡ºå£' },
    ];

    const itineraryData = [
      { day: 'Day 1', date: '12/20 (å…­)', theme: 'æŠµé”æ±äº¬ & æ± è¢‹', location: 'æ±äº¬', acts: [
        { t: '06:10', c: 'æ¡ƒåœ’é£›æˆç”° (IT200)', type: 'flight-takeoff' }, // icon: flight-takeoff-line
        { t: '11:00', c: 'æ± è¢‹ Parco (Harbs, Onitsuka)', type: 'shopping-bag' },
        { t: 'å½ˆæ€§', c: 'å¤ªé™½åŸ (3coins)', type: 'gift' } // icon: gift-line
      ]},
      { day: 'Day 2', date: '12/21 (æ—¥)', theme: 'æ–°å®¿ç‡’è‚‰ & é»ç‡ˆ', location: 'æ±äº¬', acts: [
        { t: '11:00', c: 'åˆé¤ï¼šå…­æ­Œä»™ç‡’è‚‰', type: 'restaurant' }, // icon: restaurant-line
        { t: 'ä¸‹åˆ', c: 'æ–°å®¿é€›è¡— (Beams)', type: 'shopping-bag' },
        { t: 'æ™šä¸Š', c: 'æ–°å®¿/å…­æœ¬æœ¨ è–èª•é»ç‡ˆ', type: 'map-pin' }
      ]},
      { day: 'Day 3', date: '12/22 (ä¸€)', theme: 'è±ªå¾·å¯ºè²“è²“', location: 'æ±äº¬', acts: [
        { t: 'ä¸Šåˆ', c: 'è±ªå¾·å¯ºåƒæ‹œ (6:00-17:00)', type: 'map-pin' },
        { t: 'ä¸‹åˆ', c: 'ä¸–ç”°è°·æ•£ç­–', type: 'cup' } // icon: cup-line
      ]},
      // ã€æ–°å¢è¡Œç¨‹ã€‘è¤‡è£½è²¼ä¸Šé€™ä¸€æ®µä¾†æ–°å¢ Day 4/5/6...
      { day: 'Day 4', date: '12/23 (äºŒ)', theme: 'æ½®æµè–åœ°å·¡ç¦®', location: 'æ±äº¬', acts: [
        { t: 'å…¨æ—¥', c: 'ç«¹ä¸‹é€šã€è¡¨åƒé“ã€æ¾€è°·', type: 'shopping-bag' }
      ]},
      { day: 'Day 5', date: '12/24 (ä¸‰)', theme: 'é£›å¾€é¦–çˆ¾', location: 'ç§»å‹•', acts: [
        { t: '14:35', c: 'æˆç”°é£›ä»å· (TW244)', type: 'flight-takeoff' },
        { t: 'æ™šé¤', c: 'å¼˜å¤§çƒ¤è‚‰/çƒ¤é°»é­š', type: 'restaurant' }
      ]},
      { day: 'Day 8', date: '12/27 (å…­)', theme: 'æœ€å¾Œè¡åˆº & å›å®¶', location: 'å›ç¨‹', acts: [
        { t: 'ä¸Šåˆ', c: 'é€€æˆ¿ï¼Œå¼˜å¤§æœ€å¾Œæ¡è³¼', type: 'shopping-bag' },
        { t: '15:30', c: 'æ­ AREX å»æ©Ÿå ´', type: 'train' }, // icon: train-line
        { t: '20:15', c: 'ä»å·é£›æ¡ƒåœ’ (CI163)', type: 'flight-takeoff' }
      ]}
    ];

    const lists = {
      jp: ['Hoka æ¯›æ¯›èŸ²æ‹–é‹', 'åˆåˆ©ä»–å‘½', 'è±ªå¾·å¯ºè²“å’ª', '3coinsè¡Œæè¢‹', 'UGGé›ªé´'],
      kr: ['è—¥å±€ç—˜ç—˜è—¥', 'Olive Youngé¤…ä¹¾', 'Olive Youngé»‘å˜‰éº—', 'ç”Ÿé«®ç²¾è¯', 'å…ç¨…è¸'],
      pack: ['è¡Œå‹•é›»æº', 'å……é›»ç·š/è½‰æ¥é ­', 'è­·ç…§/è‡ºå¹£', 'ç¶²å¡/ä¿éšª', 'è¡ŒææŸå¸¶/è¢‹', 'åŒ–å¦/ä¿é¤Šå“', 'é›¨å‚˜']
    };

    const budget = [
      { i: 'æ©Ÿç¥¨ä¾†å›', c: 18847 }, { i: 'æ—¥æœ¬äº¤é€šå¡', c: 1991 }, { i: 'æ—¥æœ¬ä½å®¿', c: 6628 },
      { i: 'éŸ“åœ‹ä½å®¿', c: 3253 }, { i: 'éŸ“åœ‹è¡Œææ‰˜é‹', c: 1471 }, { i: 'ç¶²å¡/ä¿éšª', c: 1000 }
    ];

    // --- è²»ç”¨è¨ˆç®—çµ„ä»¶ (æ–°å¢åŠŸèƒ½) ---
    const BudgetRow = ({ item, initialCost, totalBudget }) => {
      const storageKey = `expense_${item.replace(/\s/g, '')}`;
      const [spent, setSpent] = useState(
        parseInt(localStorage.getItem(storageKey) || '0', 10)
      );

      const handleChange = (e) => {
        const value = parseInt(e.target.value || '0', 10);
        setSpent(value);
        localStorage.setItem(storageKey, value);
        totalBudget.update(); // è§¸ç™¼çˆ¶çµ„ä»¶æ›´æ–°ç¸½è¨ˆ
      };

      const displayCost = initialCost > 0 ? initialCost.toLocaleString() : '-';
      const isOver = spent > initialCost && initialCost > 0;

      return (
        <div className="flex justify-between text-sm py-2 border-b border-vibe-shadow/50 last:border-0 items-center">
          <span className="text-gray-500 w-1/3">{item}</span>
          <span className="w-1/4 text-right text-gray-400">{displayCost}</span>
          <div className="w-1/3 text-right">
            <input
              type="number"
              value={spent === 0 ? '' : spent}
              onChange={handleChange}
              placeholder="0"
              className={`w-full text-right bg-vibe-bg border-b ${isOver ? 'border-red-500 text-red-600' : 'border-gray-300'} focus:outline-none focus:border-vibe-accent transition`}
            />
          </div>
        </div>
      );
    };


    // --- ä¸»è¦ App çµ„ä»¶ ---
    function App() {
      const [activeTab, setActiveTab] = useState('overview');
      const [openDay, setOpenDay] = useState('Day 1');
      const [activeList, setActiveList] = useState('shopping');
      const [refreshKey, setRefreshKey] = useState(0); 
      const forceRefresh = () => setRefreshKey(prev => prev + 1);

      const TabBtn = ({ id, label, icon }) => (
        <button onClick={() => setActiveTab(id)} 
          className={`flex flex-col items-center justify-center w-full py-2 transition ${activeTab === id ? 'text-vibe-accent' : 'text-gray-400'}`}>
          <div className={activeTab === id ? 'scale-110 transition' : ''}><RiIcon name={icon} size={24} /></div>
          <span className="text-[10px] font-bold mt-1">{label}</span>
        </button>
      );

      const CheckItem = ({ text, k }) => {
        const [checked, setChecked] = useState(localStorage.getItem(k) === 'true');
        const toggle = () => {
          const n = !checked; setChecked(n); localStorage.setItem(k, n);
        };
        return (
          <div onClick={toggle} className={`flex items-center gap-3 p-3 rounded-xl border mb-2 cursor-pointer transition shadow-sm ${checked ? 'bg-vibe-rose-100/50 border-vibe-rose-100' : 'bg-vibe-card border-vibe-shadow/50'}`}>
            <div className={`w-5 h-5 rounded flex items-center justify-center shrink-0 ${checked ? 'bg-vibe-accent' : 'border border-gray-300'}`}>
              {checked && <RiIcon name="check-fill" size={14} className="text-white" />}
            </div>
            <span className={`text-sm ${checked ? 'text-gray-400 line-through' : 'text-vibe-primary'}`}>{text}</span>
          </div>
        );
      };

      // --- ç¸½è²»ç”¨è¨ˆç®—é‚è¼¯ (æ–°å¢åŠŸèƒ½) ---
      const getTotalSpent = () => {
        let total = 0;
        budget.forEach(b => {
          const storageKey = `expense_${b.i.replace(/\s/g, '')}`;
          const spent = parseInt(localStorage.getItem(storageKey) || '0', 10);
          total += spent;
        });
        return total;
      };
      const totalBudgetCost = budget.reduce((a, b) => a + b.c, 0);
      const totalSpent = getTotalSpent();
      const variance = totalBudgetCost - totalSpent;
      const varianceColor = variance >= 0 ? 'text-vibe-blue-700' : 'text-vibe-rose-700';


      return (
        <div className="flex justify-center bg-gray-100 min-h-screen font-sans">
          <div className="w-full max-w-md bg-vibe-bg shadow-xl relative flex flex-col h-screen">
            {/* é ‚éƒ¨ */}
            <div className="h-1 bg-gradient-to-r from-vibe-accent to-vibe-primary shrink-0"></div>
            <div className="pt-6 px-4 shrink-0 pb-2">
              <h1 className="text-2xl font-black text-vibe-primary">Tokyo <span className="text-gray-400">&</span> Seoul</h1>
              <p className="text-xs text-gray-500 font-medium">Dec 20 - Dec 27, 2025</p>
            </div>

            {/* å…§å®¹å€ (å¯æ»¾å‹•) */}
            <main className="flex-1 overflow-y-auto p-4 pb-24 no-scrollbar">
              
              {/* ç¸½è¦½é é¢ */}
              {activeTab === 'overview' && <div className="animate-fadeIn space-y-4">
                <div className="space-y-3">
                  {flightsData.map(f => (
                    <div key={f.id} className="bg-vibe-card p-4 rounded-xl shadow-md border-l-4 relative" style={{borderColor: f.color === 'rose' ? '#fda4af' : '#7dd3fc'}}>
                      <div className="flex justify-between text-xs font-bold text-gray-400 mb-2">
                        <span>{f.type} Â· {f.date}</span><span>{f.airline}</span>
                      </div>
                      <div className="flex justify-between items-end text-vibe-primary">
                        <div className="font-bold text-lg">{f.dep.split(' ')[2]}<div className="text-xs font-normal text-gray-500">{f.dep.split(' ')[0]}</div></div>
                        <RiIcon name="plane-line" size={16} className="text-gray-400 mb-1 mx-2" />
                        <div className="font-bold text-lg text-right">{f.arr.split(' ')[2]}<div className="text-xs font-normal text-gray-500">{f.arr.split(' ')[0]}</div></div>
                      </div>
                    </div>
                  ))}
                </div>
                <div className="space-y-3 pt-2">
                  <h2 className="font-bold text-gray-400 text-sm">ACCOMMODATION</h2>
                  {accommodationData.map((h, i) => (
                    <div key={i} className="bg-vibe-card p-4 rounded-xl shadow-md">
                      <div className="font-bold text-vibe-accent text-xs mb-1">{h.location}</div>
                      <div className="font-bold mb-1">{h.hotel}</div>
                      <div className="text-xs text-gray-500 flex gap-2"><RiIcon name="calendar-line" size={14}/> {h.dates}</div>
                    </div>
                  ))}
                </div>
              </div>}

              {/* è¡Œç¨‹é é¢ */}
              {activeTab === 'itinerary' && <div className="animate-fadeIn space-y-3">
                {itineraryData.map((day) => (
                  <div key={day.day} className="bg-vibe-card rounded-xl shadow-md border border-vibe-shadow/50 overflow-hidden">
                    <div onClick={() => setOpenDay(openDay === day.day ? null : day.day)} className={`p-4 flex justify-between items-center transition cursor-pointer ${openDay === day.day ? 'bg-vibe-bg' : ''}`}>
                      <div>
                        <div className="text-xs font-bold text-vibe-accent">{day.date}</div>
                        <div className="font-bold text-sm">{day.day} Â· {day.theme}</div>
                      </div>
                    </div>
                    {openDay === day.day && (
                      <div className="px-4 pb-4 pt-2 bg-vibe-bg border-t border-vibe-shadow/50">
                        {day.acts.map((act, i) => (
                          <div key={i} className="flex gap-3 mb-3 last:mb-0">
                            <div className="text-xs text-gray-400 w-10 text-right pt-1 shrink-0">{act.t}</div>
                            {/* ã€ä¿®æ”¹å€å¡Šã€‘æ–°å¢åœ°åœ–å°èˆªåŠŸèƒ½ */}
                            <a 
                                href={`https://www.google.com/maps/search/?api=1&query={act.c}`} 
                                target="_blank" 
                                className="bg-vibe-card p-2 rounded-lg shadow-sm text-sm border border-vibe-shadow/50 w-full flex gap-2 items-start text-vibe-primary transition active:scale-[0.99] active:bg-vibe-bg/50 cursor-pointer">
                              <span className="text-vibe-accent mt-0.5 shrink-0"><RiIcon name={`${act.type}-line`} size={14}/></span>
                              <span className="underline underline-offset-2 decoration-dotted hover:decoration-solid">{act.c}</span>
                            </a>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                ))}
              </div>}

              {/* æ¸…å–®é é¢ */}
              {activeTab === 'lists' && <div className="animate-fadeIn">
                <div className="flex bg-vibe-shadow rounded-lg p-1 mb-4">
                  <button onClick={() => setActiveList('shopping')} className={`flex-1 py-1.5 rounded-md text-xs font-bold transition ${activeList === 'shopping' ? 'bg-vibe-card shadow text-vibe-accent' : 'text-gray-500'}`}>ğŸ›ï¸ è³¼ç‰©</button>
                  <button onClick={() => setActiveList('packing')} className={`flex-1 py-1.5 rounded-md text-xs font-bold transition ${activeList === 'packing' ? 'bg-vibe-card shadow text-vibe-primary' : 'text-gray-500'}`}>ğŸ’ è¡Œæ</button>
                </div>
                {activeList === 'shopping' ? (
                  <>
                    <h3 className="text-sm font-bold text-gray-400 mb-2 mt-4">JAPAN</h3>
                    {lists.jp.map((item, i) => <CheckItem key={i} text={item} k={`jp_${i}`} />)}
                    <h3 className="text-sm font-bold text-gray-400 mb-2 mt-6">KOREA</h3>
                    {lists.kr.map((item, i) => <CheckItem key={i} text={item} k={`kr_${i}`} />)}
                  </>
                ) : (
                   lists.pack.map((item, i) => <CheckItem key={i} text={item} k={`pk_${i}`} />)
                )}
              </div>}

              {/* ç­†è¨˜é é¢ (åŒ…å«èŠ±è²»è¨ˆç®—) */}
              {activeTab === 'notes' && <div className="animate-fadeIn">
                 <div className="bg-vibe-bg p-4 rounded-xl border border-vibe-shadow mb-6 shadow-sm">
                   <h3 className="font-bold text-vibe-primary text-sm mb-2 flex items-center gap-2"><RiIcon name="alert-line" size={16} className="text-vibe-accent"/> å¾…ç¢ºèªäº‹é …</h3>
                   <ul className="text-xs text-gray-600 list-disc pl-4 space-y-1">
                     <li>ç¶²å¡ & å…¥å¢ƒé€£çµ (VJW/Q-Code)</li>
                     <li>æ±äº¬å¦™ç¾©ç¥ç¤¾ (é€±ä¸‰ä¼‘)</li>
                     <li>å…­æœ¬æœ¨è–èª•é»ç‡ˆ</li>
                   </ul>
                 </div>
                 
                 {/* ã€ä¿®æ”¹å€å¡Šã€‘æ–°å¢èŠ±è²»è¨ˆç®—åŠŸèƒ½ */}
                 <h3 className="font-bold text-gray-700 mb-3">é ç®—/å¯¦éš›èŠ±è²» (å–®ä½ï¼šTWD)</h3>
                 <div className="bg-vibe-card p-4 rounded-xl shadow-md" key={refreshKey}>
                     {/* æ¨™é¡Œè¡Œ */}
                     <div className="flex justify-between text-xs font-bold py-1 mb-2 border-b border-gray-200">
                         <span className="w-1/3 text-gray-400">é …ç›®</span>
                         <span className="w-1/4 text-right text-gray-400">é ç®—</span>
                         <span className="w-1/3 text-right text-gray-400">å¯¦éš›æ”¯å‡º</span>
                     </div>
                     
                     {/* é …ç›®åˆ—è¡¨ (ä½¿ç”¨ BudgetRow çµ„ä»¶) */}
                     {budget.map((b, i) => (
                         <BudgetRow key={i} item={b.i} initialCost={b.c} totalBudget={{ update: forceRefresh }} />
                     ))}
                     
                     {/* ç¸½è¨ˆ */}
                     <div className="flex justify-between pt-3 font-bold mt-2 border-t border-gray-100">
                         <span>ç¸½é ç®—</span>
                         <span className="text-gray-700">${totalBudgetCost.toLocaleString()}</span>
                     </div>
                     
                     <div className="flex justify-between py-1 font-bold">
                         <span>å¯¦éš›ç¸½èŠ±è²»</span>
                         <span className="text-vibe-accent">${totalSpent.toLocaleString()}</span>
                     </div>

                     {/* å·®ç•°/çµé¤˜ */}
                     <div className="flex justify-between pt-2 mt-2 border-t border-gray-100">
                         <span className="font-bold text-vibe-primary">çµé¤˜/è¶…æ”¯</span>
                         <span className={`font-black ${varianceColor}`}>
                             {variance >= 0 ? '+' : ''}${variance.toLocaleString()}
                         </span>
                     </div>
                 </div>
              </div>}

            </main>

            {/* åº•éƒ¨å°èˆª */}
            <nav className="bg-vibe-card/95 backdrop-blur border-t border-vibe-shadow p-2 pb-6 shrink-0 flex justify-around shadow-lg">
              <TabBtn id="overview" label="ç¸½è¦½" icon="home-line" />
              <TabBtn id="itinerary" label="è¡Œç¨‹" icon="calendar-line" />
              <TabBtn id="lists" label="æ¸…å–®" icon="checkbox-line" />
              <TabBtn id="notes" label="è¨ˆç®—" icon="currency-line" />
            </nav>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
